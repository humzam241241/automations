{
  "name": "example_advanced",
  "description": "Advanced profile with pipeline, search query, and master dataset",
  "input_source": "graph",
  "email_selection": {
    "search_query": "from:billing@company.com AND subject:invoice",
    "after_date": "2026-01-01",
    "newest_n": 50
  },
  "schema": {
    "columns": [
      {"name": "Subject", "type": "text"},
      {"name": "From", "type": "text"},
      {"name": "Date", "type": "datetime"},
      {"name": "Invoice_Number", "type": "text"},
      {"name": "Amount", "type": "text"},
      {"name": "Urgent", "type": "text"}
    ]
  },
  "rules": [
    {
      "column": "Invoice_Number",
      "regex": "INV-\\d{5,}",
      "value": "MATCH",
      "unmatched_value": "",
      "search_in": ["subject", "body"]
    },
    {
      "column": "Amount",
      "regex": "\\$[0-9,]+\\.\\d{2}",
      "value": "FOUND",
      "unmatched_value": "",
      "search_in": ["body"]
    },
    {
      "column": "Urgent",
      "keywords": ["urgent", "asap", "immediate"],
      "value": "Yes",
      "unmatched_value": "No",
      "word_boundary": true,
      "search_in": ["subject"],
      "priority": 100
    }
  ],
  "pipeline": ["email_to_table", "append_to_master"],
  "master_dataset": {
    "path": "./output/invoices_master.xlsx",
    "deduplicate_column": "Subject"
  },
  "output": {
    "format": "excel",
    "destination": "local",
    "local_path": "./output",
    "filename_template": "invoices_{timestamp}.xlsx"
  }
}
